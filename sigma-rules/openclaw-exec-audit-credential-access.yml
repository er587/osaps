title: OpenClaw Credential File/Environment Access
id: f6a7b8c9-d0e1-2345-f012-567890123456
status: experimental
description: Detects attempts to read API keys, tokens, or secrets from files or environment variables
author: Eric (a network security professional)
date: 2026/02/02
references:
    - https://github.com/er587/osaps
    - https://attack.mitre.org/techniques/T1552/001/
logsource:
    product: openclaw
    service: exec-audit
detection:
    # Reading OpenClaw secrets
    selection_openclaw_secrets:
        log_type: openclaw-exec
        command|contains:
            - '.openclaw/.env'
            - '.openclaw/openclaw.json'
            - 'openclaw.json'
            - 'ANTHROPIC_API_KEY'
            - 'OPENAI_API_KEY'
            - 'TELEGRAM_BOT_TOKEN'
    
    # Reading common credential files
    selection_credential_files:
        log_type: openclaw-exec
        command|re: '(cat|less|more|head|tail|grep|awk|sed|bat|view|vim|nano).*'
        command|contains:
            - '.env'
            - '.netrc'
            - '.npmrc'
            - '.pypirc'
            - '.docker/config.json'
            - '.aws/credentials'
            - '.azure/'
            - '.gcloud/'
            - 'credentials.json'
            - 'secrets.json'
            - 'config.json'
            - 'service-account'
    
    # Reading SSH/GPG keys
    selection_ssh_keys:
        log_type: openclaw-exec
        command|re: '(cat|less|more|head|tail|cp|scp|rsync).*'
        command|contains:
            - '.ssh/id_'
            - '.ssh/config'
            - '.gnupg/'
            - 'id_rsa'
            - 'id_ed25519'
            - 'id_ecdsa'
            - '.pem'
            - '.key'
            - 'private'
    
    # Environment variable extraction
    selection_env_extraction:
        log_type: openclaw-exec
        command|re: '(env|printenv|export|echo \$|printf.*\$).*'
        command|contains:
            - 'API'
            - 'KEY'
            - 'TOKEN'
            - 'SECRET'
            - 'PASSWORD'
            - 'CREDENTIAL'
            - 'AUTH'
    
    # Searching for secrets
    selection_secret_search:
        log_type: openclaw-exec
        command|re: '(grep|rg|ag|find|locate|mdfind).*(-r|-R|--recursive)?.*'
        command|contains:
            - 'api_key'
            - 'apikey'
            - 'api-key'
            - 'secret'
            - 'password'
            - 'token'
            - 'credential'
            - 'bearer'
            - 'auth'
    
    # Git credential access
    selection_git_credentials:
        log_type: openclaw-exec
        command|contains:
            - 'git credential'
            - '.git-credentials'
            - '.gitconfig'
            - 'GIT_TOKEN'
            - 'GITHUB_TOKEN'
            - 'GITLAB_TOKEN'
    
    # Cloud provider credentials
    selection_cloud_creds:
        log_type: openclaw-exec
        command|contains:
            - 'AWS_ACCESS_KEY'
            - 'AWS_SECRET'
            - 'AZURE_'
            - 'GOOGLE_APPLICATION_CREDENTIALS'
            - 'GCP_'
            - 'DIGITALOCEAN'
            - 'LINODE'
            - 'VULTR'
    
    # Database credentials
    selection_db_creds:
        log_type: openclaw-exec
        command|contains:
            - 'DATABASE_URL'
            - 'DB_PASSWORD'
            - 'POSTGRES_PASSWORD'
            - 'MYSQL_PASSWORD'
            - 'MONGO_URI'
            - 'REDIS_URL'
            - '.pgpass'
            - '.my.cnf'
    
    condition: selection_openclaw_secrets or selection_credential_files or selection_ssh_keys or selection_env_extraction or selection_secret_search or selection_git_credentials or selection_cloud_creds or selection_db_creds
falsepositives:
    - Legitimate configuration management
    - Backup operations
    - Developer debugging
level: high
tags:
    - attack.credential_access
    - attack.t1552.001
    - attack.t1552.004
    - attack.discovery
    - attack.t1083
