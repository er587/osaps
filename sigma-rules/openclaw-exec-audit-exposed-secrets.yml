title: OpenClaw Exposed API Key/Token in Command
id: a7b8c9d0-e1f2-3456-0123-678901234567
status: experimental
description: Detects API keys or tokens appearing directly in exec commands (potential exposure)
author: Eric (a network security professional)
date: 2026/02/02
references:
    - https://github.com/er587/osaps
    - https://attack.mitre.org/techniques/T1552/
logsource:
    product: openclaw
    service: exec-audit
detection:
    # Anthropic API key pattern (sk-ant-...)
    selection_anthropic_key:
        log_type: openclaw-exec
        command|re: 'sk-ant-[a-zA-Z0-9_-]{20,}'
    
    # OpenAI API key pattern (sk-...)
    selection_openai_key:
        log_type: openclaw-exec
        command|re: 'sk-[a-zA-Z0-9]{32,}'
    
    # OpenAI project key pattern (sk-proj-...)
    selection_openai_proj_key:
        log_type: openclaw-exec
        command|re: 'sk-proj-[a-zA-Z0-9_-]{20,}'
    
    # GitHub token patterns
    selection_github_token:
        log_type: openclaw-exec
        command|re: '(ghp_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9_]{22,}|gho_[a-zA-Z0-9]{36}|ghu_[a-zA-Z0-9]{36}|ghs_[a-zA-Z0-9]{36})'
    
    # GitLab token
    selection_gitlab_token:
        log_type: openclaw-exec
        command|re: 'glpat-[a-zA-Z0-9_-]{20,}'
    
    # Slack tokens
    selection_slack_token:
        log_type: openclaw-exec
        command|re: 'xox[baprs]-[a-zA-Z0-9-]+'
    
    # Discord tokens
    selection_discord_token:
        log_type: openclaw-exec
        command|re: '[MN][A-Za-z\d]{23,}\.[\w-]{6}\.[\w-]{27}'
    
    # Telegram bot token
    selection_telegram_token:
        log_type: openclaw-exec
        command|re: '\d{8,10}:[a-zA-Z0-9_-]{35}'
    
    # AWS access key
    selection_aws_key:
        log_type: openclaw-exec
        command|re: '(AKIA|ABIA|ACCA|ASIA)[A-Z0-9]{16}'
    
    # AWS secret key (40 char base64-ish)
    selection_aws_secret:
        log_type: openclaw-exec
        command|re: '[A-Za-z0-9/+=]{40}'
        command|contains:
            - 'AWS'
            - 'aws'
            - 'secret'
    
    # Google API key
    selection_google_key:
        log_type: openclaw-exec
        command|re: 'AIza[0-9A-Za-z_-]{35}'
    
    # Stripe API key
    selection_stripe_key:
        log_type: openclaw-exec
        command|re: '(sk_live_|sk_test_|pk_live_|pk_test_)[a-zA-Z0-9]{24,}'
    
    # Twilio
    selection_twilio:
        log_type: openclaw-exec
        command|re: 'SK[a-f0-9]{32}'
    
    # SendGrid
    selection_sendgrid:
        log_type: openclaw-exec
        command|re: 'SG\.[a-zA-Z0-9_-]{22}\.[a-zA-Z0-9_-]{43}'
    
    # Mailgun
    selection_mailgun:
        log_type: openclaw-exec
        command|re: 'key-[a-zA-Z0-9]{32}'
    
    # Generic bearer token in header
    selection_bearer:
        log_type: openclaw-exec
        command|re: '(Bearer|bearer|Authorization|authorization)[:\s]+[a-zA-Z0-9_-]{20,}'
    
    # Generic long hex secrets (32+ chars)
    selection_hex_secret:
        log_type: openclaw-exec
        command|re: '(api[_-]?key|token|secret|password|auth)[=:"\s]+[a-f0-9]{32,}'
    
    # Generic base64 encoded secrets
    selection_base64_secret:
        log_type: openclaw-exec
        command|re: '(api[_-]?key|token|secret|password|auth)[=:"\s]+[A-Za-z0-9+/=]{40,}'
    
    condition: selection_anthropic_key or selection_openai_key or selection_openai_proj_key or selection_github_token or selection_gitlab_token or selection_slack_token or selection_discord_token or selection_telegram_token or selection_aws_key or selection_aws_secret or selection_google_key or selection_stripe_key or selection_twilio or selection_sendgrid or selection_mailgun or selection_bearer or selection_hex_secret or selection_base64_secret
falsepositives:
    - Testing with example/dummy keys
    - Key rotation scripts (should be rare)
level: critical
tags:
    - attack.credential_access
    - attack.t1552
    - attack.exfiltration
    - attack.t1020
