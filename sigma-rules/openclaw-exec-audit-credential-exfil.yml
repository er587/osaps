title: OpenClaw API Key/Token Exfiltration Attempt
id: e5f6a7b8-c9d0-1234-ef01-456789012345
status: experimental
description: Detects attempts to exfiltrate API keys, tokens, or secrets via OpenClaw exec commands
author: Eric (a network security professional)
date: 2026/02/02
references:
    - https://github.com/er587/osaps
    - https://attack.mitre.org/techniques/T1552/
logsource:
    product: openclaw
    service: exec-audit
detection:
    # Exfiltration via curl/wget with sensitive data
    selection_curl_with_secrets:
        log_type: openclaw-exec
        command|re: 'curl.*(ANTHROPIC|OPENAI|API[_-]?KEY|TOKEN|SECRET|PASSWORD|BEARER).*(-d|--data|-X POST)'
    
    selection_curl_env_expansion:
        log_type: openclaw-exec
        command|re: 'curl.*\$\{?(ANTHROPIC|OPENAI|API|TOKEN|SECRET|KEY|PASSWORD)'
    
    # Piping secrets to network tools
    selection_pipe_to_network:
        log_type: openclaw-exec
        command|re: '(cat|echo|printf).*\|.*(curl|wget|nc|netcat|socat)'
        command|contains:
            - 'API'
            - 'KEY'
            - 'TOKEN'
            - 'SECRET'
    
    # Sending to known paste/file sharing services
    selection_paste_services:
        log_type: openclaw-exec
        command|contains:
            - 'pastebin.com'
            - 'paste.ee'
            - 'hastebin'
            - 'dpaste'
            - 'transfer.sh'
            - 'file.io'
            - '0x0.st'
            - 'ix.io'
            - 'sprunge.us'
            - 'termbin.com'
            - 'ghostbin'
    
    # Webhook exfiltration
    selection_webhook_exfil:
        log_type: openclaw-exec
        command|re: 'curl.*(webhook|discord\.com/api/webhooks|hooks\.slack\.com|notify)'
        command|contains:
            - 'API'
            - 'KEY'
            - 'TOKEN'
            - 'SECRET'
    
    # Base64 encoding secrets (obfuscation attempt)
    selection_base64_secrets:
        log_type: openclaw-exec
        command|re: 'base64.*\|.*curl|echo.*\|.*base64.*\|.*(curl|wget|nc)'
    
    condition: selection_curl_with_secrets or selection_curl_env_expansion or selection_pipe_to_network or selection_paste_services or selection_webhook_exfil or selection_base64_secrets
falsepositives:
    - Legitimate API testing
    - Webhook integrations (should be allowlisted)
level: critical
tags:
    - attack.exfiltration
    - attack.t1041
    - attack.credential_access
    - attack.t1552.001
